import"./base-D0W_z4C0.js";import{a as Z,E as h}from"./el-tab-pane-cWjDPzn_.js";import{E as ee,a as le}from"./el-table-column-CDM3P5m5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-CopSMgxi.js";import"./el-scrollbar-jtoLF5oP.js";import{E as te,a as ae,b as oe}from"./el-select-D2Kip8AO.js";import{E as ne}from"./el-input-B9UNxcP1.js";import{E as se}from"./el-col-CSuhXc0r.js";import{E as ue}from"./el-row-NQ-m2tyU.js";import{_ as ie,E as N,a as f,q as v,h as re,j as t,y as R,k as l,g as b,A as i,I as de,u as d,H as p,J as k,F as P,K as M,G as pe}from"./index-BxSgbHR9.js";import{s as me,af as fe,J as be,a5 as _e}from"./constants-BbhSUWfP.js";import"./style-CkmzvMaN.js";import{s as ye,m as ve,d as ge}from"./problem-CBfDY5G8.js";import{E as z}from"./MdEditor-DBQ-iJ2m.js";import{E as g}from"./request-Doo85ERT.js";import{E as D}from"./index-Bb38MZfH.js";import{E as xe}from"./index-C1y4kZ_Q.js";import{E as Ve}from"./index-BSl0X_TB.js";import"./aria-BUADUvnR.js";import"./vnode-CU6LxloI.js";import"./isEqual-DMp6TwhZ.js";import"./focus-trap-t7Ag-kVD.js";import"./scroll-Kwgiw4mU.js";import"./index-r5W6hzzQ.js";import"./index-BvgBipFQ.js";import"./aria-nkjrUMQ-.js";const we={class:"main-box"},ce={key:1,class:"detail-box"},Ee={__name:"ModifyProblem",setup(ke){const S=pe(),o=N({problem_id:"",title:"",problem_code:"",description:"",limit_time:null,limit_memory:null,input:"",output:"",input_desc:"",output_desc:"",level:null,hint:""}),T=N({}),U=f("first"),K=[{label:"1s",value:"1"},{label:"2s",value:"2"},{label:"3s",value:"3"},{label:"4s",value:"4"}],F=[{label:"32MB",value:32},{label:"64MB",value:64},{label:"128MB",value:128},{label:"256MB",value:256}],H=[{label:"Easy",value:1},{label:"Easy+",value:2},{label:"Normal",value:3},{label:"Normal+",value:4},{label:"Hard",value:5}],x=f(""),C=f(null),V=f(""),I=async()=>{if(V.value===""){g.error({message:"请先选择查询选项, 再进行搜索",plain:!0});return}else if(x.value===""){g.warning({message:"请输入关键词进行搜索",plain:!0});return}const n=new URLSearchParams;n.append(V.value,x.value),n.append("page_size","50");const e=await ye(n);e&&(C.value=e.problems,g.success({message:"查询成功",plain:!0}))},w=f(!0),O=n=>{switch(n){case 1:return"Easy";case 2:return"Easy+";case 3:return"Normal";case 4:return"Normal+";case 5:return"Hard"}},j=n=>{switch(n){case 1:return"info";case 2:return"success";case 3:return"primary";case 4:return"warning";case 5:return"danger"}},A=n=>new Date(n*1e3).toLocaleString(),J=(n,e)=>{const u=S.resolve({path:`/problem/${e.ProblemId}`});window.open(u.href,"_blank")},c=f(!1),q=n=>{o.problem_id=n.ProblemId,o.title=n.Title,o.problem_code=n.ProblemCode,o.description=n.Description,o.limit_time=n.LimitTime,o.limit_memory=n.LimitMemory,o.input=n.Input,o.output=n.Output,o.input_desc=n.SampleInput,o.output_desc=n.SampleOutput,o.level=n.Level,o.hint=n.Hint,Object.assign(T,o)},G=async(n,e)=>{w.value=!1,q(e)},B=async()=>{try{c.value=!0;const n=new FormData;n.append("problem_id",o.problem_id);for(const u in o)T[u]!==o[u]&&n.append(u,o[u]);await ve(n)?D({title:"修改题目成功",type:"success"}):g.error({message:"修改失败",plain:!0})}finally{c.value=!1}},X=async(n,e)=>{try{await xe.confirm("确定删除当前题目吗？",`题目：${e.ProblemCode}	${e.Title}`,{confirmButtonText:"确定",cancelButtonText:"取消"});const u=new FormData;u.append("problem_id",e.ProblemId),await ge(u)?(C.value.splice(n,1),D({title:"删除题目成功",type:"success"})):g.error({message:"删除失败",plain:!0})}catch{}};return(n,e)=>{const u=ue,s=se,_=te,E=ae,m=ne,y=Ve,r=ee,Q=oe,W=le,L=h,Y=Z;return b(),v("div",we,[w.value?(b(),re(Y,{key:0,modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=a=>U.value=a)},{default:t(()=>[l(L,{label:"修改题目",name:"first"},{default:t(()=>[l(u,null,{default:t(()=>e[15]||(e[15]=[i("span",{style:{"font-size":"30px"}},"修改题目",-1)])),_:1}),l(u,null,{default:t(()=>[l(s,{span:12},{default:t(()=>e[16]||(e[16]=[i("span",null,"请先进行题目搜索，再进行修改",-1)])),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:4},{default:t(()=>e[17]||(e[17]=[i("span",null,"搜索题目",-1)])),_:1}),l(s,{span:20},{default:t(()=>[l(y,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),style:{"max-width":"650px"},placeholder:"请输入题目名或题号, 查询要修改的题目是否存在",class:"input-with-select",size:"large",onKeydown:de(I,["enter"])},{prepend:t(()=>[l(E,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),placeholder:"查询选项",style:{width:"120px"},size:"large"},{default:t(()=>[l(_,{label:"题目名",value:"title"}),l(_,{label:"题号",value:"problem_code"})]),_:1},8,["modelValue"])]),append:t(()=>[l(m,{onClick:I,icon:d(me),size:"large"},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(W,{data:C.value,border:"",style:{width:"100%",cursor:"pointer"}},{default:t(()=>[l(r,{type:"index",width:"50px"}),l(r,{prop:"ProblemCode",label:"题号",width:"100px"}),l(r,{prop:"Title",label:"题目名"}),l(r,{label:"时间限制",width:"100px"},{default:t(a=>[p(k(`${a.row.LimitTime} s`),1)]),_:1}),l(r,{label:"空间限制",width:"100px"},{default:t(a=>[p(k(`${a.row.LimitMemory} MB`),1)]),_:1}),l(r,{label:"难度",width:"100px"},{default:t(a=>[l(Q,{type:j(a.row.Level)},{default:t(()=>[p(k(O(a.row.Level)),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"创建时间",width:"180px"},{default:t(a=>[p(k(A(a.row.Addtime)),1)]),_:1}),l(r,{label:"查看题目",width:"100"},{default:t(a=>[l(m,{type:"success",size:"large",circle:"",icon:d(fe),onClick:$=>J(a.$index,a.row)},null,8,["icon","onClick"])]),_:1}),l(r,{label:"修改题目",width:"100"},{default:t(a=>[l(m,{type:"primary",size:"large",circle:"",icon:d(be),onClick:$=>G(a.$index,a.row)},null,8,["icon","onClick"])]),_:1}),l(r,{label:"删除题目",width:"100"},{default:t(a=>[l(m,{type:"danger",size:"large",circle:"",icon:d(_e),onClick:$=>X(a.$index,a.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),l(L,{label:"操作说明",name:"second"},{default:t(()=>e[18]||(e[18]=[p("Role")])),_:1})]),_:1},8,["modelValue"])):R("",!0),w.value?R("",!0):(b(),v("div",ce,[l(u,null,{default:t(()=>[l(s,{span:4},{default:t(()=>e[19]||(e[19]=[i("span",{style:{"font-size":"24px","font-weight":"600"}},"修改题目信息",-1)])),_:1}),l(s,{span:20,style:{"text-align":"right"}},{default:t(()=>[l(m,{type:"danger",size:"large",style:{"font-size":"16px"},onClick:e[3]||(e[3]=a=>w.value=!0)},{default:t(()=>e[20]||(e[20]=[p("返回查询")])),_:1}),l(m,{type:"primary",size:"large",style:{"font-size":"16px"},onClick:B,loading:c.value},{default:t(()=>e[21]||(e[21]=[p("提交修改")])),_:1},8,["loading"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[22]||(e[22]=[i("span",null,"题号",-1)])),_:1}),l(s,{span:4},{default:t(()=>[l(y,{modelValue:o.problem_code,"onUpdate:modelValue":e[4]||(e[4]=a=>o.problem_code=a),clearable:""},null,8,["modelValue"])]),_:1}),l(s,{span:2},{default:t(()=>e[23]||(e[23]=[i("span",null,"题目名称",-1)])),_:1}),l(s,{span:4},{default:t(()=>[l(y,{modelValue:o.title,"onUpdate:modelValue":e[5]||(e[5]=a=>o.title=a),clearable:""},null,8,["modelValue"])]),_:1}),l(s,{span:2},{default:t(()=>e[24]||(e[24]=[i("span",null,"时间限制",-1)])),_:1}),l(s,{span:4},{default:t(()=>[l(E,{modelValue:o.limit_time,"onUpdate:modelValue":e[6]||(e[6]=a=>o.limit_time=a),placeholder:"时间限制",style:{"min-width":"100px"}},{default:t(()=>[(b(),v(P,null,M(K,a=>l(_,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(s,{span:2},{default:t(()=>e[25]||(e[25]=[i("span",null,"空间限制",-1)])),_:1}),l(s,{span:4},{default:t(()=>[l(E,{modelValue:o.limit_memory,"onUpdate:modelValue":e[7]||(e[7]=a=>o.limit_memory=a),placeholder:"空间限制",style:{"min-width":"100px"}},{default:t(()=>[(b(),v(P,null,M(F,a=>l(_,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[26]||(e[26]=[i("span",null,"输入样例",-1)])),_:1}),l(s,{span:10},{default:t(()=>[l(y,{modelValue:o.input,"onUpdate:modelValue":e[8]||(e[8]=a=>o.input=a),type:"textarea",autosize:{minRows:2,maxRows:5},clearable:""},null,8,["modelValue"]),e[27]||(e[27]=i("p",{style:{"font-size":"14px","font-weight":"400"}},"可使用Markdown的代码段来展示测试数据：```1 2```",-1))]),_:1}),l(s,{span:2},{default:t(()=>e[28]||(e[28]=[i("span",null,"输出样例",-1)])),_:1}),l(s,{span:10},{default:t(()=>[l(y,{modelValue:o.output,"onUpdate:modelValue":e[9]||(e[9]=a=>o.output=a),type:"textarea",autosize:{minRows:2,maxRows:5},clearable:""},null,8,["modelValue"]),e[29]||(e[29]=i("p",{style:{"font-size":"14px","font-weight":"400"}},"可使用Markdown的代码段来展示测试数据：```3```",-1))]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[30]||(e[30]=[i("span",null,"题目描述",-1)])),_:1}),l(s,{span:22},{default:t(()=>[l(d(z),{modelValue:o.description,"onUpdate:modelValue":e[10]||(e[10]=a=>o.description=a),editorId:"description",theme:"light","code-theme":"atom",style:{"max-height":"500px"}},null,8,["modelValue"]),e[31]||(e[31]=i("p",{style:{"font-size":"14px","font-weight":"400"}},"希望更丰富的展现？使用 Markdown、KaTeX。",-1))]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[32]||(e[32]=[i("span",null,"输入格式",-1)])),_:1}),l(s,{span:22},{default:t(()=>[l(d(z),{modelValue:o.input_desc,"onUpdate:modelValue":e[11]||(e[11]=a=>o.input_desc=a),editorId:"input_type",theme:"light","code-theme":"atom",style:{"max-height":"150px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[33]||(e[33]=[i("span",null,"输出格式",-1)])),_:1}),l(s,{span:22},{default:t(()=>[l(d(z),{modelValue:o.output_desc,"onUpdate:modelValue":e[12]||(e[12]=a=>o.output_desc=a),editorId:"output_type",theme:"light","code-theme":"atom",style:{"max-height":"150px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[34]||(e[34]=[i("span",null,"提示说明",-1)])),_:1}),l(s,{span:22},{default:t(()=>[l(d(z),{modelValue:o.hint,"onUpdate:modelValue":e[13]||(e[13]=a=>o.hint=a),editorId:"output_type",theme:"light","code-theme":"atom",style:{"max-height":"200px"}},null,8,["modelValue"]),e[35]||(e[35]=i("p",{style:{"font-size":"14px","font-weight":"400"}},"记得填入数据范围",-1))]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>e[36]||(e[36]=[i("span",null,"题目难度",-1)])),_:1}),l(s,{span:6},{default:t(()=>[l(E,{modelValue:o.level,"onUpdate:modelValue":e[14]||(e[14]=a=>o.level=a),placeholder:"题目难度",style:{"min-width":"100px"}},{default:t(()=>[(b(),v(P,null,M(H,a=>l(_,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(u,null,{default:t(()=>[l(s,{span:2},{default:t(()=>[l(m,{type:"primary",size:"large",onClick:B,loading:c.value},{default:t(()=>e[37]||(e[37]=[p("提交修改")])),_:1},8,["loading"])]),_:1})]),_:1})]))])}}},Ze=ie(Ee,[["__scopeId","data-v-5399a7b1"]]);export{Ze as default};
