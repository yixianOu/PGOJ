import"./base-D0W_z4C0.js";import{a as w,E as V}from"./el-form-item-DJ5B80l7.js";import{E as C}from"./el-input-B9UNxcP1.js";import{_ as I,E as B,a as c,q as S,A as i,k as t,j as s,C as L,I as M,g as N,u as v,H as r,J as T,G as q,f as F}from"./index-BxSgbHR9.js";import{m as K,l as U}from"./constants-BbhSUWfP.js";import{e as $,s as j}from"./login-DmyFmSrL.js";import{E}from"./request-Doo85ERT.js";import{E as A}from"./index-C1y4kZ_Q.js";import{E as D}from"./index-BSl0X_TB.js";import"./_baseClone-C9TxUIFe.js";import"./index-r5W6hzzQ.js";import"./userinfo-DyPuNU-m.js";import"./userinfo-CQJB7s17.js";import"./aria-BUADUvnR.js";import"./index-BvgBipFQ.js";import"./scroll-Kwgiw4mU.js";import"./vnode-CU6LxloI.js";import"./aria-nkjrUMQ-.js";import"./focus-trap-t7Ag-kVD.js";const G={class:"login"},H={class:"login-box"},J={class:"btn"},R={class:"link"},h={__name:"LoginCode",setup(z){const x={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确邮箱",trigger:"blur"}]},a=B({email:"",email_code:""}),m=c(!1),b=q(),u=async()=>{var e;m.value=!0;const o=await $(a);if(console.log(o),o){const l=(e=o==null?void 0:o.user_info)==null?void 0:e.role_level;l&&l===2?(E({message:"登陆成功",type:"success",plain:!0}),await b.push("/admin")):E({message:"登陆失败, 非管理员用户",type:"error",plain:!0})}m.value=!1},d=c(!1),n=c("发送验证码"),y=async()=>{if(!a.email){await A.alert("邮箱未输入, 请先输入正确邮箱地址","请先输入邮箱");return}await j(a.email),d.value=!0;let o=20;n.value=`${o}秒后重新发送`;const e=setInterval(()=>{o--,n.value=`${o}秒后重新发送`,o===0&&(d.value=!1,n.value="发送验证码",clearInterval(e))},1e3)};return(o,e)=>{const l=D,_=V,f=C,g=F("router-link"),k=w;return N(),S("div",G,[i("div",H,[e[5]||(e[5]=i("div",{class:"logo"},[i("span",null,"验证码登录")],-1)),t(k,{onSubmit:L(u,["prevent"]),onKeyup:M(u,["enter"]),model:a,rules:x},{default:s(()=>[t(_,{prop:"email"},{default:s(()=>[t(l,{modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=p=>a.email=p),class:"input",placeholder:"邮箱","prefix-icon":v(K)},null,8,["modelValue","prefix-icon"])]),_:1}),t(_,{prop:"email_code"},{default:s(()=>[t(l,{modelValue:a.email_code,"onUpdate:modelValue":e[1]||(e[1]=p=>a.email_code=p),class:"input",placeholder:"验证码","prefix-icon":v(U)},{append:s(()=>[t(f,{disabled:d.value,onClick:y},{default:s(()=>[r(T(n.value),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue","prefix-icon"])]),_:1}),i("div",J,[t(f,{onClick:u,type:"success",class:"btn_item",loading:m.value},{default:s(()=>e[2]||(e[2]=[r("登录")])),_:1},8,["loading"])]),i("div",R,[t(g,{to:"/admin/login"},{default:s(()=>e[3]||(e[3]=[r("密码登录")])),_:1}),t(g,{to:"/admin/register"},{default:s(()=>e[4]||(e[4]=[r("注册")])),_:1})])]),_:1},8,["model"])])])}}},pe=I(h,[["__scopeId","data-v-a186eaac"]]);export{pe as default};
