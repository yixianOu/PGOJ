import"./base-D0W_z4C0.js";import{E as de}from"./el-overlay-CCOOi3hO.js";import{E as pe,j as me}from"./upload-Cz_KuT_x.js";import{a as fe,E as ce}from"./el-tab-pane-cWjDPzn_.js";import{E as _e,a as ge}from"./el-table-column-CDM3P5m5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-CopSMgxi.js";import"./el-scrollbar-jtoLF5oP.js";import{E as ve,a as ye,b as be}from"./el-select-D2Kip8AO.js";import{E as we}from"./el-input-B9UNxcP1.js";import{E as xe}from"./el-col-CSuhXc0r.js";import{E as Fe}from"./el-row-NQ-m2tyU.js";import{s as Ee,$ as q,L as ke,J as Te,a5 as Ce,a4 as D,P as K,a6 as Ve,E as $e}from"./constants-BbhSUWfP.js";import{s as Re}from"./problem-CBfDY5G8.js";import{i as W,E as f}from"./request-Doo85ERT.js";import{_ as Ne,a as g,E as ze,q as Q,h as T,j as t,y as E,k as l,g as y,A as u,u as p,H as d,J as B}from"./index-BxSgbHR9.js";import{E as S}from"./index-Bb38MZfH.js";import{E as Pe}from"./index-C1y4kZ_Q.js";import{E as Ue}from"./index-BSl0X_TB.js";import"./index-BvgBipFQ.js";import"./scroll-Kwgiw4mU.js";import"./vnode-CU6LxloI.js";import"./focus-trap-t7Ag-kVD.js";import"./aria-BUADUvnR.js";import"./_baseClone-C9TxUIFe.js";import"./isEqual-DMp6TwhZ.js";import"./userinfo-DyPuNU-m.js";import"./index-r5W6hzzQ.js";import"./aria-nkjrUMQ-.js";const De=C=>W.get("/api2/test_cases",{params:C}).then(m=>m.data).catch(m=>(f({message:`服务错误: ${m}`,type:"error",plain:!0}),Promise.reject(m))),Ie=C=>W.delete(`/api3/test_cases/${C}`).then(m=>!m.data).catch(m=>(f({message:`服务错误: ${m}`,type:"error",plain:!0}),Promise.reject(m))),Le={class:"main-box"},Be={key:1,class:"add-box"},Se={__name:"ManageTestcase",setup(C){const m=g("first"),c=g("1"),V=g(""),$=g(""),M=g(null),X=async()=>{if($.value===""){f.error({message:"请先选择查询选项, 再进行搜索",plain:!0});return}else if(V.value===""){f.warning({message:"请输入关键词进行搜索",plain:!0});return}const a=new URLSearchParams;a.append($.value,V.value),a.append("page_size","50");const e=await Re(a);e&&(M.value=e.problems,f.success({message:"查询成功",plain:!0}))},Y=a=>{switch(a){case 1:return"Easy";case 2:return"Easy+";case 3:return"Normal";case 4:return"Normal+";case 5:return"Hard"}},Z=a=>{switch(a){case 1:return"info";case 2:return"success";case 3:return"primary";case 4:return"warning";case 5:return"danger"}},A=a=>new Date(a*1e3).toLocaleString(),b=g(!1),w=g(null),x=g(null),s=ze({pid:null,test_group:null,test_id:null,inFile:null,outFile:null,problemName:"请搜索题目并点击题目进行选择",table_idx:null}),h=async()=>{try{b.value=!0;const a=new FormData;return a.append("problem_id",s.pid),a.append("sample_input",s.inFile),a.append("sample_output",s.outFile),await me(a)}catch{}finally{b.value=!1}},R=(a,e)=>{e==="inputFile"?(w.value.clearFiles(),w.value.handleStart(a[0]),s.inFile=a[0]):(x.value.clearFiles(),x.value.handleStart(a[0]),s.outFile=a[0])},N=(a,e)=>{e==="inputFile"?s.inFile=a.raw:s.outFile=a.raw},F=a=>{a==="inputFile"?(w.value.clearFiles(),s.inFile=null):a==="outputFile"?(x.value.clearFiles(),s.outFile=null):(w.value.clearFiles(),x.value.clearFiles(),s.inFile=null,s.outFile=null)},v=g(null),j=async()=>{const a=new URLSearchParams;a.append("problem_id",s.pid);const e=await De(a);v.value=e.test_cases},ee=async a=>{c.value="2",s.pid=a.ProblemId,s.problemName=`${a.ProblemCode}	${a.Title}`,v.value||await j()},le=async a=>{c.value="3",s.pid=a.ProblemId,s.problemName=`${a.ProblemCode}	${a.Title}`,v.value||await j()},I=async(a,e,i)=>{a==="add"?v.value.push(i):a==="modify"?v.value[e]=i:a==="delete"&&v.value.splice(e,1)},te=async()=>{if(!s.pid){f({message:"请先搜索并选择对应题目上传测试用例",type:"warning",plain:!0});return}if(!s.inFile||!s.outFile){f({message:"请先选择上传的文件",type:"warning",plain:!0});return}const a=await h();a.test_case?(S({title:"上传成功",message:`成功上传第 ${a.test_case.TestGroup} 组测试`,type:"success",duration:20*1e3}),F("all"),await I("add",null,a.test_case)):f.error({message:"上传失败",plain:!0})},G=async a=>await Ie(a),ae=async(a,e)=>{try{await Pe.confirm("确认删除测试用例？",`当前测试用例组号： ${e.TestGroup}`,{confirmButtonText:"确认删除",cancelButtonText:"取消操作"}),await G(e.TestId)?(await I("delete",a,null),S({title:"删除成功",type:"success"})):f.error({message:"删除失败",plain:!0})}catch{}},k=g(!1),ne=(a,e)=>{s.test_group=e.TestGroup,s.test_id=e.TestId,s.table_idx=a,c.value="3",k.value=!0},se=async()=>{if(!s.pid){f({message:"请先搜索并选择对应题目上传测试用例",type:"warning",plain:!0});return}if(!s.inFile||!s.outFile){f({message:"请先选择上传的文件",type:"warning",plain:!0});return}try{if(b.value=!0,await G(s.test_id)){const e=await h();e.test_case?(S({title:"修改成功",message:`成功修改第 ${e.test_case.TestGroup} 组测试`,type:"success",duration:20*1e3}),F("all"),await I("modify",s.table_idx,e.test_case)):f.error({message:"修改失败",plain:!0})}}catch{}finally{b.value=!1,k.value=!1}};return(a,e)=>{const i=Fe,o=xe,H=ve,oe=ye,_=we,L=Ue,r=_e,ue=be,J=ge,O=ce,ie=fe,z=$e,P=pe,re=de;return y(),Q("div",Le,[c.value==="1"?(y(),T(ie,{key:0,modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),class:"demo-tabs"},{default:t(()=>[l(O,{label:"修改测试用例",name:"first"},{default:t(()=>[l(i,null,{default:t(()=>e[9]||(e[9]=[u("span",{style:{"font-size":"30px"}},"管理评测数据",-1)])),_:1}),l(i,null,{default:t(()=>[l(o,{span:12},{default:t(()=>e[10]||(e[10]=[u("span",null,"请先进行题目搜索，再进行修改",-1)])),_:1})]),_:1}),l(i,null,{default:t(()=>[l(o,{span:4},{default:t(()=>e[11]||(e[11]=[u("span",null,"搜索题目",-1)])),_:1}),l(o,{span:20},{default:t(()=>[l(L,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=n=>V.value=n),style:{"max-width":"650px"},placeholder:"请输入题目名或题号, 查询题目的测试用例详情",class:"input-with-select",size:"large"},{prepend:t(()=>[l(oe,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=n=>$.value=n),placeholder:"查询选项",style:{width:"120px"},size:"large"},{default:t(()=>[l(H,{label:"题目名",value:"title"}),l(H,{label:"题号",value:"problem_code"})]),_:1},8,["modelValue"])]),append:t(()=>[l(_,{onClick:X,icon:p(Ee),size:"large"},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(J,{data:M.value,border:"",style:{width:"100%",cursor:"pointer"}},{default:t(()=>[l(r,{type:"index",width:"50"}),l(r,{prop:"ProblemCode",label:"题号",width:"100"}),l(r,{prop:"Title",label:"题目名"}),l(r,{label:"题目难度",width:"100"},{default:t(n=>[l(ue,{type:Z(n.row.Level)},{default:t(()=>[d(B(Y(n.row.Level)),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"Author",label:"创建人",width:"150"}),l(r,{label:"创建时间",width:"180"},{default:t(n=>[d(B(A(n.row.Addtime)),1)]),_:1}),l(r,{label:"新增测试用例",width:"150"},{default:t(n=>[l(_,{type:"success",icon:p(q),onClick:U=>ee(n.row)},{default:t(()=>e[12]||(e[12]=[d("新增用例")])),_:2},1032,["icon","onClick"])]),_:1}),l(r,{label:"编辑测试用例",width:"150"},{default:t(n=>[l(_,{type:"primary",icon:p(ke),onClick:U=>le(n.row)},{default:t(()=>e[13]||(e[13]=[d("进行编辑")])),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),l(O,{label:"操作说明",name:"second"},{default:t(()=>e[14]||(e[14]=[d("Role")])),_:1})]),_:1},8,["modelValue"])):E("",!0),c.value!=="1"?(y(),Q("div",Be,[l(i,null,{default:t(()=>[c.value==="2"?(y(),T(o,{key:0,span:4},{default:t(()=>e[15]||(e[15]=[u("span",{style:{"font-size":"30px","font-weight":"600"}},"新增测试用例",-1)])),_:1})):E("",!0),c.value==="3"?(y(),T(o,{key:1,span:4},{default:t(()=>e[16]||(e[16]=[u("span",{style:{"font-size":"30px","font-weight":"600"}},"编辑测试用例",-1)])),_:1})):E("",!0),l(o,{span:20,style:{"text-align":"right"}},{default:t(()=>[l(_,{type:"info",size:"large",style:{"font-size":"16px"},onClick:e[3]||(e[3]=n=>c.value="1")},{default:t(()=>e[17]||(e[17]=[d("返回")])),_:1})]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(o,{span:4},{default:t(()=>e[18]||(e[18]=[u("span",null,"测试用例详情",-1)])),_:1}),l(o,{span:20},{default:t(()=>[l(J,{data:v.value,border:"",style:{width:"100%",cursor:"pointer"}},{default:t(()=>[l(r,{type:"index",width:"50"}),l(r,{prop:"TestGroup",label:"组号",width:"70"}),l(r,{label:"最后修改时间"},{default:t(n=>[d(B(A(n.row.UpdateAt)),1)]),_:1}),l(r,{prop:"TestInputFileName",label:"输入文件"}),l(r,{prop:"TestOutputFileName",label:"输出文件"}),l(r,{label:"新增用例",width:"100"},{default:t(n=>[l(_,{type:"success",size:"large",circle:"",icon:p(q),onClick:e[4]||(e[4]=U=>c.value="2")},null,8,["icon"])]),_:1}),l(r,{label:"修改用例",width:"100"},{default:t(n=>[l(_,{type:"primary",size:"large",circle:"",icon:p(Te),onClick:U=>ne(n.$index,n.row)},null,8,["icon","onClick"])]),_:1}),l(r,{label:"删除用例",width:"100"},{default:t(n=>[l(_,{type:"danger",size:"large",circle:"",icon:p(Ce),onClick:U=>ae(n.$index,n.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),l(re,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=n=>k.value=n),title:"上传新测试用例以进行更改",width:"800"},{default:t(()=>[l(i,null,{default:t(()=>[l(o,{span:5},{default:t(()=>e[19]||(e[19]=[u("span",null,"当前选定用例号",-1)])),_:1}),l(o,{span:3},{default:t(()=>[l(L,{modelValue:s.test_group,"onUpdate:modelValue":e[5]||(e[5]=n=>s.test_group=n),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(o,{span:4},{default:t(()=>e[20]||(e[20]=[u("span",null,"输入用例",-1)])),_:1}),l(o,{span:20},{default:t(()=>[l(P,{ref_key:"inputRef",ref:w,class:"upload-demo","auto-upload":!1,"on-exceed":n=>R(n,"inputFile"),"on-change":n=>N(n,"inputFile"),"on-remove":()=>F("inputFile"),limit:1,drag:""},{default:t(()=>[l(z,{class:"el-icon--upload"},{default:t(()=>[l(p(D))]),_:1}),e[21]||(e[21]=u("div",{class:"el-upload__text"},[d(" 拖拽上传或 "),u("em",null,"点击上传")],-1))]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(o,{span:4},{default:t(()=>e[22]||(e[22]=[u("span",null,"输出用例",-1)])),_:1}),l(o,{span:20},{default:t(()=>[l(P,{ref_key:"outputRef",ref:x,class:"upload-demo","auto-upload":!1,"on-exceed":n=>R(n,"outputFile"),"on-change":n=>N(n,"outputFile"),"on-remove":()=>F("outputFile"),limit:1,drag:""},{default:t(()=>[l(z,{class:"el-icon--upload"},{default:t(()=>[l(p(D))]),_:1}),e[23]||(e[23]=u("div",{class:"el-upload__text"},[d(" 拖拽上传或 "),u("em",null,"点击上传")],-1))]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1})]),_:1}),l(i,null,{default:t(()=>[l(o,{span:12,style:{"text-align":"left","padding-right":"0"}},{default:t(()=>[l(_,{onClick:se,type:"primary",icon:p(K),loading:b.value},{default:t(()=>e[24]||(e[24]=[d("上传测试")])),_:1},8,["icon","loading"])]),_:1}),l(o,{span:12,style:{"text-align":"right","padding-right":"0"}},{default:t(()=>[l(_,{onClick:e[6]||(e[6]=n=>k.value=!1),type:"danger",icon:p(Ve)},{default:t(()=>e[25]||(e[25]=[d("取消操作")])),_:1},8,["icon"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c.value==="2"?(y(),T(i,{key:0},{default:t(()=>[l(o,{span:4,style:{"font-size":"22px","font-weight":"600"}},{default:t(()=>e[26]||(e[26]=[d("上传新增用例")])),_:1})]),_:1})):E("",!0),c.value==="2"?(y(),T(i,{key:1},{default:t(()=>[l(o,{span:3},{default:t(()=>e[27]||(e[27]=[u("span",null,"当前选定题目",-1)])),_:1}),l(o,{span:5},{default:t(()=>[l(L,{modelValue:s.problemName,"onUpdate:modelValue":e[8]||(e[8]=n=>s.problemName=n),disabled:""},null,8,["modelValue"])]),_:1}),l(o,{span:2},{default:t(()=>e[28]||(e[28]=[u("span",null,"输入用例",-1)])),_:1}),l(o,{span:5},{default:t(()=>[l(P,{ref_key:"inputRef",ref:w,class:"upload-demo","auto-upload":!1,"on-exceed":n=>R(n,"inputFile"),"on-change":n=>N(n,"inputFile"),"on-remove":()=>F("inputFile"),limit:1,drag:""},{default:t(()=>[l(z,{class:"el-icon--upload"},{default:t(()=>[l(p(D))]),_:1}),e[29]||(e[29]=u("div",{class:"el-upload__text"},[d(" 拖拽上传或 "),u("em",null,"点击上传")],-1))]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1}),l(o,{span:2},{default:t(()=>e[30]||(e[30]=[u("span",null,"输出用例",-1)])),_:1}),l(o,{span:5},{default:t(()=>[l(P,{ref_key:"outputRef",ref:x,class:"upload-demo","auto-upload":!1,"on-exceed":n=>R(n,"outputFile"),"on-change":n=>N(n,"outputFile"),"on-remove":()=>F("outputFile"),limit:1,drag:""},{default:t(()=>[l(z,{class:"el-icon--upload"},{default:t(()=>[l(p(D))]),_:1}),e[31]||(e[31]=u("div",{class:"el-upload__text"},[d(" 拖拽上传或 "),u("em",null,"点击上传")],-1))]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1}),l(o,{span:2,style:{"text-align":"right","padding-right":"0"}},{default:t(()=>[l(_,{onClick:te,type:"primary",icon:p(K),loading:b.value},{default:t(()=>e[32]||(e[32]=[d("上传测试")])),_:1},8,["icon","loading"])]),_:1})]),_:1})):E("",!0)])):E("",!0)])}}},cl=Ne(Se,[["__scopeId","data-v-12e595ab"]]);export{cl as default};
