import{i,E as s}from"./request-Doo85ERT.js";import{u as m}from"./userinfo-DyPuNU-m.js";import{b as u}from"./userinfo-CQJB7s17.js";const p=m(),g=(r,t)=>{const e=new FormData;for(const n in r)e.append(n,r[n]);const o=t?"/api1/users/email/login":"/api1/users/login";return i.post(o,e).then(n=>{const a=n.data;if(a.token)return p.setInfo("token",a.token),p.setInfo("userInfo",JSON.stringify(a.user_info)),u(),a;a.code&&s({message:`登陆失败: ${a.message}`,type:"error",plain:!0})}).catch(n=>(s({message:"登陆失败, 服务异常",type:"error",plain:!0}),Promise.reject(n)))},y=r=>{const t=new FormData;for(const e in r)t.append(e,r[e]);return i.post("/api1/users",t).then(e=>(e.data?s({message:"注册失败",type:"error",plain:!0}):s({message:"注册成功",type:"success",plain:!0}),e.data)).catch(e=>(s({message:"注册失败, 服务异常",type:"error",plain:!0}),Promise.reject(e)))},I=r=>{const t=new FormData;for(const e in r)t.append(e,r[e]);return i.post("/api1/users/email/login",t).then(e=>{const o=e.data;if(o.token)return userInfoStore.setInfo("token",o.token),userInfoStore.setInfo("userInfo",JSON.stringify(o.user_info)),u(),o;o.code&&s({message:"登陆失败",type:"error",plain:!0})}).catch(e=>(s({message:"登陆失败, 服务异常",type:"error",plain:!0}),Promise.reject(e)))},d=r=>{i.get("/api1/users/email",{params:{email:r}}).catch(t=>(s({message:"验证码发送失败, 服务异常",type:"error",plain:!0}),Promise.reject(t)))};export{I as e,g as l,y as r,d as s};
