import"./base-D0W_z4C0.js";import{a as le,E as te}from"./el-tab-pane-cWjDPzn_.js";import{j as ae,E as oe}from"./upload-Cz_KuT_x.js";import{E as ne,a as ue}from"./el-table-column-CDM3P5m5.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-CopSMgxi.js";import"./el-scrollbar-jtoLF5oP.js";import{E as se,a as ie,b as pe}from"./el-select-D2Kip8AO.js";import{E as de}from"./el-input-B9UNxcP1.js";import{E as re}from"./el-row-NQ-m2tyU.js";import{E as me}from"./el-col-CSuhXc0r.js";import{_ as fe,a as b,E as C,q as E,k as l,j as t,g as U,A as s,F as M,K as z,u as m,H as d,I as _e,J as k}from"./index-BxSgbHR9.js";import"./style-CkmzvMaN.js";import{s as be,a4 as $,P as ve}from"./constants-BbhSUWfP.js";import{a as ge,s as ye}from"./problem-CBfDY5G8.js";import{E as c}from"./MdEditor-DBQ-iJ2m.js";import{E as f}from"./request-Doo85ERT.js";import{E as K}from"./index-Bb38MZfH.js";import{E as we}from"./index-BSl0X_TB.js";import"./aria-BUADUvnR.js";import"./vnode-CU6LxloI.js";import"./_baseClone-C9TxUIFe.js";import"./isEqual-DMp6TwhZ.js";import"./userinfo-DyPuNU-m.js";import"./focus-trap-t7Ag-kVD.js";import"./scroll-Kwgiw4mU.js";import"./index-r5W6hzzQ.js";const Ve={class:"main-box"},xe={__name:"AddProblem",setup(Fe){const L=b("first"),H=[{label:"1s",value:"1"},{label:"2s",value:"2"},{label:"3s",value:"3"},{label:"4s",value:"4"}],j=[{label:"32MB",value:32},{label:"64MB",value:64},{label:"128MB",value:128},{label:"256MB",value:256}],q=[{label:"Easy",value:1},{label:"Easy+",value:2},{label:"Normal",value:3},{label:"Normal+",value:4},{label:"Hard",value:5}],n=C({title:"",problem_code:"",description:"",limit_time:"",limit_memory:"",input:"",output:"",input_desc:"",output_desc:"",level:null,hint:"",source:""}),N=C(!1),G=()=>{let o="";return n.title||(o+="题目名称 "),n.limit_time||(o+="时间限制 "),n.limit_memory||(o+="空间限制 "),n.input||(o+="输入样例 "),n.output||(o+="输出样例 "),n.input_desc||(o+="输入格式 "),n.output_desc||(o+="输出格式"),`<p>请填写如下字段:</p><br><strong>${o}</strong>`},J=async()=>{if(!n.title||!n.description||!n.limit_memory||!n.limit_time||!n.input||!n.output||!n.input_desc||!n.output_desc){f.warning({message:G(),plain:!0,dangerouslyUseHTMLString:!0,duration:10*1e3});return}try{N.value=!0;const o=new FormData;for(const u in n)o.append(u,n[u]);await ge(o)?K({title:"新建题目成功",message:"成功创建当前题目",type:"success"}):f.error({message:"新增题目失败",plain:!0})}finally{N.value=!1}},V=b(""),x=b(""),B=b(null),I=async()=>{if(x.value===""){f.error({message:"请先选择查询选项, 再进行搜索",plain:!0});return}else if(V.value===""){f.warning({message:"请输入关键词进行搜索",plain:!0});return}const o=new URLSearchParams;o.append(x.value,V.value),o.append("page_size","50");const e=await ye(o);e&&(B.value=e.problems,f.success({message:"查询成功",plain:!0}))},O=o=>{switch(o){case 1:return"Easy";case 2:return"Easy+";case 3:return"Normal";case 4:return"Normal+";case 5:return"Hard"}},X=o=>{switch(o){case 1:return"info";case 2:return"success";case 3:return"primary";case 4:return"warning";case 5:return"danger"}},Q=o=>new Date(o*1e3).toLocaleString(),W=o=>{i.pid=o.ProblemId,i.problemName=`${o.ProblemCode}	${o.Title}`},R=b(!1),g=b(null),y=b(null),i=C({pid:null,inFile:null,outFile:null,problemName:"请搜索题目并点击题目进行选择"}),Y=async()=>{if(!i.pid){f.warning({message:"请先搜索并选择对应题目上传测试用例",plain:!0});return}if(!i.inFile||!i.outFile){f({message:"请先选择上传的文件, 或重新选择文件上传",type:"warning",plain:!0});return}R.value=!0;try{const o=new FormData;o.append("problem_id",i.pid),o.append("sample_input",i.inFile),o.append("sample_output",i.outFile);const e=await ae(o);e.test_case?(K({title:"上传成功",message:`成功上传第 ${e.test_case.TestGroup} 组测试`,type:"success",duration:20*1e3}),T("all")):f.error({message:"上传失败",plain:!0})}finally{R.value=!1}},S=(o,e)=>{e==="inputFile"?(g.value.clearFiles(),g.value.handleStart(o[0]),i.inFile=o[0]):(y.value.clearFiles(),y.value.handleStart(o[0]),i.outFile=o[0])},A=(o,e)=>{e==="inputFile"?i.inFile=o.raw:i.outFile=o.raw},T=o=>{o==="inputFile"?(g.value.clearFiles(),i.inFile=null):o==="outputFile"?(y.value.clearFiles(),i.outFile=null):(g.value.clearFiles(),y.value.clearFiles(),i.inFile=null,i.outFile=null)};return(o,e)=>{const u=me,_=we,w=se,F=ie,p=re,v=de,P=te,r=ne,Z=pe,h=ue,D=oe,ee=le;return U(),E("div",Ve,[l(ee,{modelValue:L.value,"onUpdate:modelValue":e[15]||(e[15]=a=>L.value=a),class:"demo-tabs"},{default:t(()=>[l(P,{label:"新增题目",name:"first"},{default:t(()=>[l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[16]||(e[16]=[s("span",null,"题号",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(_,{modelValue:n.problem_code,"onUpdate:modelValue":e[0]||(e[0]=a=>n.problem_code=a),clearable:""},null,8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>e[17]||(e[17]=[s("span",null,"题目名称",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(_,{modelValue:n.title,"onUpdate:modelValue":e[1]||(e[1]=a=>n.title=a),clearable:""},null,8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>e[18]||(e[18]=[s("span",null,"时间限制",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(F,{modelValue:n.limit_time,"onUpdate:modelValue":e[2]||(e[2]=a=>n.limit_time=a),placeholder:"时间限制",style:{"min-width":"100px"}},{default:t(()=>[(U(),E(M,null,z(H,a=>l(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>e[19]||(e[19]=[s("span",null,"空间限制",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(F,{modelValue:n.limit_memory,"onUpdate:modelValue":e[3]||(e[3]=a=>n.limit_memory=a),placeholder:"空间限制",style:{"min-width":"100px"}},{default:t(()=>[(U(),E(M,null,z(j,a=>l(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[20]||(e[20]=[s("span",null,"输入样例",-1)])),_:1}),l(u,{span:10},{default:t(()=>[l(_,{modelValue:n.input,"onUpdate:modelValue":e[4]||(e[4]=a=>n.input=a),type:"textarea",autosize:{minRows:2,maxRows:5},clearable:""},null,8,["modelValue"]),e[21]||(e[21]=s("p",{style:{"font-size":"14px","font-weight":"400"}},"可使用Markdown的代码段来展示测试数据：```1 2```",-1))]),_:1}),l(u,{span:2},{default:t(()=>e[22]||(e[22]=[s("span",null,"输出样例",-1)])),_:1}),l(u,{span:10},{default:t(()=>[l(_,{modelValue:n.output,"onUpdate:modelValue":e[5]||(e[5]=a=>n.output=a),type:"textarea",autosize:{minRows:2,maxRows:5},clearable:""},null,8,["modelValue"]),e[23]||(e[23]=s("p",{style:{"font-size":"14px","font-weight":"400"}},"可使用Markdown的代码段来展示测试数据：```3```",-1))]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[24]||(e[24]=[s("span",null,"题目描述",-1)])),_:1}),l(u,{span:22},{default:t(()=>[l(m(c),{modelValue:n.description,"onUpdate:modelValue":e[6]||(e[6]=a=>n.description=a),editorId:"description",theme:"light","code-theme":"atom",style:{"max-height":"500px"}},null,8,["modelValue"]),e[25]||(e[25]=s("p",{style:{"font-size":"14px","font-weight":"400"}},"希望更丰富的展现？使用 Markdown、KaTeX。",-1))]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[26]||(e[26]=[s("span",null,"输入格式",-1)])),_:1}),l(u,{span:22},{default:t(()=>[l(m(c),{modelValue:n.input_desc,"onUpdate:modelValue":e[7]||(e[7]=a=>n.input_desc=a),editorId:"input_type",theme:"light","code-theme":"atom",style:{"max-height":"150px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[27]||(e[27]=[s("span",null,"输出格式",-1)])),_:1}),l(u,{span:22},{default:t(()=>[l(m(c),{modelValue:n.output_desc,"onUpdate:modelValue":e[8]||(e[8]=a=>n.output_desc=a),editorId:"output_type",theme:"light","code-theme":"atom",style:{"max-height":"150px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[28]||(e[28]=[s("span",null,"提示说明",-1)])),_:1}),l(u,{span:22},{default:t(()=>[l(m(c),{modelValue:n.hint,"onUpdate:modelValue":e[9]||(e[9]=a=>n.hint=a),editorId:"output_type",theme:"light","code-theme":"atom",style:{"max-height":"200px"}},null,8,["modelValue"]),e[29]||(e[29]=s("p",{style:{"font-size":"14px","font-weight":"400"}},"记得填入数据范围",-1))]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>e[30]||(e[30]=[s("span",null,"题目难度",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(F,{modelValue:n.level,"onUpdate:modelValue":e[10]||(e[10]=a=>n.level=a),placeholder:"题目难度",style:{"min-width":"100px"}},{default:t(()=>[(U(),E(M,null,z(q,a=>l(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>e[31]||(e[31]=[s("span",null,"题目来源",-1)])),_:1}),l(u,{span:4},{default:t(()=>[l(_,{modelValue:n.source,"onUpdate:modelValue":e[11]||(e[11]=a=>n.source=a),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:2},{default:t(()=>[l(v,{type:"primary",onClick:J,loading:N},{default:t(()=>e[32]||(e[32]=[d("新建题目")])),_:1},8,["loading"])]),_:1}),l(u,{span:2},{default:t(()=>[l(v,{type:"danger"},{default:t(()=>e[33]||(e[33]=[d("取消操作")])),_:1})]),_:1})]),_:1})]),_:1}),l(P,{label:"上传测试用例",name:"second"},{default:t(()=>[l(p,null,{default:t(()=>[l(u,{span:12},{default:t(()=>e[34]||(e[34]=[s("span",null,"请先新建题目，再上传测试数据",-1)])),_:1})]),_:1}),l(p,null,{default:t(()=>[l(u,{span:4},{default:t(()=>e[35]||(e[35]=[s("span",null,"搜索题目",-1)])),_:1}),l(u,{span:20},{default:t(()=>[l(_,{modelValue:V.value,"onUpdate:modelValue":e[13]||(e[13]=a=>V.value=a),style:{"max-width":"650px"},placeholder:"请输入题目名或题号, 查询要上传测试用例的题目是否存在",class:"input-with-select",size:"large",onKeydown:_e(I,["enter"])},{prepend:t(()=>[l(F,{modelValue:x.value,"onUpdate:modelValue":e[12]||(e[12]=a=>x.value=a),placeholder:"查询选项",style:{width:"120px"},size:"large"},{default:t(()=>[l(w,{label:"题目名",value:"title"}),l(w,{label:"题号",value:"problem_code"})]),_:1},8,["modelValue"])]),append:t(()=>[l(v,{onClick:I,icon:m(be),size:"large"},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,null,{default:t(()=>[l(h,{data:B.value,border:"",style:{width:"100%",cursor:"pointer"},"highlight-current-row":"",onCurrentChange:W},{default:t(()=>[l(r,{type:"index",width:"50"}),l(r,{prop:"ProblemCode",label:"题号",width:"100px"}),l(r,{prop:"Title",label:"题目名"}),l(r,{label:"时间限制",width:"100px"},{default:t(a=>[d(k(`${a.row.LimitTime} s`),1)]),_:1}),l(r,{label:"空间限制",width:"100px"},{default:t(a=>[d(k(`${a.row.LimitMemory} MB`),1)]),_:1}),l(r,{label:"难度",width:"100px"},{default:t(a=>[l(Z,{type:X(a.row.Level)},{default:t(()=>[d(k(O(a.row.Level)),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"创建时间",width:"180px"},{default:t(a=>[d(k(Q(a.row.Addtime)),1)]),_:1}),l(r,{prop:"Author",label:"创建人",width:"125px"}),l(r,{prop:"Source",label:"题目来源",width:"125px"})]),_:1},8,["data"])]),_:1}),l(p,null,{default:t(()=>[l(u,{span:3},{default:t(()=>e[36]||(e[36]=[s("span",null,"当前选定题目",-1)])),_:1}),l(u,{span:7},{default:t(()=>[l(_,{modelValue:i.problemName,"onUpdate:modelValue":e[14]||(e[14]=a=>i.problemName=a),disabled:""},null,8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>e[37]||(e[37]=[s("span",null,"输入用例",-1)])),_:1}),l(u,{span:3},{default:t(()=>[l(D,{ref_key:"inputRef",ref:g,class:"upload-demo","auto-upload":!1,"on-exceed":a=>S(a,"inputFile"),"on-change":a=>A(a,"inputFile"),"on-remove":()=>T("inputFile"),limit:1},{default:t(()=>[l(v,{icon:m($)},{default:t(()=>e[38]||(e[38]=[d("选择输入文件")])),_:1},8,["icon"])]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1}),l(u,{span:2},{default:t(()=>e[39]||(e[39]=[s("span",null,"输出用例",-1)])),_:1}),l(u,{span:3},{default:t(()=>[l(D,{ref_key:"outputRef",ref:y,class:"upload-demo","auto-upload":!1,"on-exceed":a=>S(a,"outputFile"),"on-change":a=>A(a,"outputFile"),"on-remove":()=>T("outputFile"),limit:1},{default:t(()=>[l(v,{icon:m($)},{default:t(()=>e[40]||(e[40]=[d("选择输出文件")])),_:1},8,["icon"])]),_:1},8,["on-exceed","on-change","on-remove"])]),_:1}),l(u,{span:4,style:{"text-align":"right","padding-right":"0"}},{default:t(()=>[l(v,{onClick:Y,type:"primary",icon:m(ve),loading:R.value},{default:t(()=>e[41]||(e[41]=[d("上传测试")])),_:1},8,["icon","loading"])]),_:1})]),_:1})]),_:1}),l(P,{label:"操作说明",name:"third"},{default:t(()=>e[42]||(e[42]=[d("Role")])),_:1})]),_:1},8,["modelValue"])])}}},We=fe(xe,[["__scopeId","data-v-607c690f"]]);export{We as default};
